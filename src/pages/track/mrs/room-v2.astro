---
import Base from "../../../layouts/Base.astro";
---

<Base title="Mrs Â· Room">

  <style>
    :root { --activation: 5; }

.mrs-room{
  min-height: 70vh;
  padding: 24px;
  border-radius: 16px;

  background:
    radial-gradient(1200px 600px at 50% 35%,
      rgba(255,255,255,0.06),
      rgba(0,0,0,0.92)
    );

  box-shadow:
    inset 0 0 140px rgba(0,0,0,0.45),
    inset 0 0 60px rgba(0,0,0,0.25);

  /* Quiet compression */
  transition: filter 4s ease;
  filter:
  contrast(calc(1 - (var(--activation) * 0.04)))
  brightness(calc(0.85 + (var(--energy) * 0.02)));
}

    .mrs-room .arch{
      width: min(560px, 92vw);
      height: 300px;
      margin: 18px auto 20px;
      border: 1px solid rgba(255,255,255,0.18);
      border-bottom: 0;
      border-top-left-radius: 999px;
      border-top-right-radius: 999px;
      box-shadow:
        0 0 calc(20px + (var(--energy) * 6px))
        rgba(255,205,140, calc(0.04 + (var(--energy) *
     0.01)));

      background:
        radial-gradient(800px 400px at 50% 80%, rgba(255,205,140,0.08), rgba(0,0,0,0));
      transform-origin: center bottom;
      animation: breathe 90s infinite ease-in-out;
    }

    .mrs-room .door{
      width: clamp(54px, 12vw, 90px);
      max-width: 90px;
      min-width: 54px;
      height: 180px;
      margin: 0 auto 28px;
      border: 1px solid rgba(255,255,255,0.06);
      border-radius: 14px;
      background: linear-gradient(
        to bottom,
        rgba(255,205,140,0.08),
        rgba(0,0,0,0)
      );
      box-shadow:
        0 0 30px rgba(255,205,140,0.06),
        inset 0 0 20px rgba(255,255,255,0.03),
        inset 0 -20px 40px rgba(255,205,140,0.04);

      transition: transform 10s ease, opacity 10s ease;
      transform-origin: center bottom;

      /* subtle narrowing */
      transform: scaleX(
  calc(
    1
    - (var(--activation) * 0.008)
    - (var(--social) * 0.01)
  )
);

  }

    .dial-panel{
      max-width: 520px;
      margin: 0 auto;
      display: grid;
      gap: 10px;
      color: rgba(255,255,255,0.85);
    }

    .snapshot{
      max-width: 520px;
      margin: 14px auto 0;
      color: rgba(255,255,255,0.85);
      font-size: 16px;
    }

    @keyframes breathe{
      0%   { transform: scale(1); }
      50%  { transform: scale(1.01); }
      100% { transform: scale(1); }
    }
  </style>

  <div class="mrs-room">
    <div class="arch"></div>
    <div class="door"></div>

    <div class="dial-panel">
      <label>Energy</label>
      <input type="range" id="energy" min="0" max="10" value="5" />

      <label>Activation</label>
      <input type="range" id="activation" min="0" max="10" value="5" />

      <label>Social Load</label>
      <input type="range" id="social" min="0" max="10" value="5" />
    </div>

    <div id="snapshot" class="snapshot"></div>
  </div>

  <script type="module">
    const energy = document.getElementById("energy");
    const activation = document.getElementById("activation");
    const social = document.getElementById("social");
    const snapshot = document.getElementById("snapshot");

    function updateRoom() {
      const e = parseInt(energy.value);
      const a = parseInt(activation.value);
      const s = parseInt(social.value);

      document.documentElement.style.setProperty("--energy", e);
      document.documentElement.style.setProperty("--activation", a);
      document.documentElement.style.setProperty("--social", s);

      snapshot.innerText = generateSnapshot(e, a, s);
      saveState(e, a, s);
    }

    function generateSnapshot(e, a, s) {
      if (e < 4 && a > 6) return "Low energy + high activation. System may feel narrow.";
      if (e > 6 && a < 4) return "Stable and resourced.";
      return "Balanced but variable.";
    }

    function saveState(e, a, s) {
      const history = JSON.parse(localStorage.getItem("mrsHistory")) || [];
      history.push({ date: Date.now(), e, a, s });
      localStorage.setItem("mrsHistory", JSON.stringify(history));
    }

    energy.addEventListener("input", updateRoom);
    activation.addEventListener("input", updateRoom);
    social.addEventListener("input", updateRoom);
    updateRoom();
  </script>

</Base>
